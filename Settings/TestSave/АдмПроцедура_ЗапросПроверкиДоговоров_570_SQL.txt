-- var mtQuery: TmcMemTable;
-- mtQuery := TmcMemTable.Create(Application);
-- SelectSQL('exec dbo.НоваяПроцедура 3, ''НовыйЗапрос2'' ', mtQuery);
Select  EOT_1.Number  Номер  ,  replace  (  replace  (  IsNULL  (  EOT_2.Name  ,  ''  )  +  ' '  +  IsNULL  (  Fl.FirstName  ,  ''  )  +  ' '  +  IsNULL  (  Fl.SecondName  ,  ''  )  ,  '  '  ,  ' '  )  ,  '  '  ,  ' '  )  ДССтрахФИО  ,  ДС.InsurerID  СтраховательИД  ,  З.FaceID  ЗФЛИД  ,  (  Case  When  EOT_2.Name  +  ' '  +  Fl.FirstName  +  ' '  +  Fl.SecondName  <  >  ATT.Column_2  Then  'Не совпадает страхователь!!!'  When  replace  (  replace  (  ATT.Column_16  ,  '  '  ,  ' '  )  ,  '  '  ,  ' '  )  <  >  replace  (  replace  (  IsNULL  (  Face1.Name  ,  ''  )  +  ' '  +  IsNULL  (  IFL.FirstName  ,  ''  )  +  ' '  +  IsNULL  (  IFL.SecondName  ,  ''  )  ,  '  '  ,  ' '  )  ,  '  '  ,  ' '  )  Then  'Не совпадает ФЛ!!!'  Else  ''  End  )  Внимание  ,  (  Case  When  ДС.InsurerID  <  >  З.FaceID  Then  'Отличаются!'  Else  ''  End  )  ОтличаютсяСЗ  ,  (  Case  When  З.ID  is  NULL  Then  'где же застрахованный?!!'  Else  'Он есть: '  +  convert  (  varchar  (  Max  )  ,  З.ID  )  End  )  ЗастрахованногоНет  From  ContractIns  ДС  left outer join Document EOT_1 on ДС.CID=EOT_1.DocumentID  left outer join Face EOT_2 on ДС.InsurerID=EOT_2.FaceID   Join  A_Table20_Test  ATT  On  ATT.Column_1  =  EOT_1.Number  Left  Outer  Join  RelContFace  З  On  З.ContractID  =  ДС.CID  Left  Outer  Join  FacePerson  IFL  On  З.FaceID  =  IFL.FaceID  Left  Outer  Join  Face  Face1  On  Face1.FaceID  =  IFL.FaceID  Left  Outer  Join  FacePerson  Fl  On  ДС.InsurerID  =  Fl.FaceID