
﻿/*
 * Создано в SharpDevelop.
 * Пользователь: Travin
 * Дата: 01.01.2018
 * Время: 13:47
 */
 
using System;
using System.Drawing;
using System.Windows.Forms;
namespace FBA
{ 
    public partial class FormGetEntity : FormSim
    {       
        public string EntityID;
        public string EntityBrief;
        public string EntityName;
                   
        public FormGetEntity(bool Ediable,
                             bool SelectInOneClick,
                             string EntityIDIN,
                             string EntityBriefIN, 
                             string EntityNameIN)
        {            
            InitializeComponent();         
            this.btnCancel.DialogResult = System.Windows.Forms.DialogResult.Cancel;
            this.btnOk.DialogResult = System.Windows.Forms.DialogResult.OK;                         
            this.EntityBrief = "";  
            CompEntityTreeFBA1.LoadEntityTree(); 
            CompEntityTreeFBA1.Editable = Ediable;
            CompEntityTreeFBA1.SelectInOneClick = SelectInOneClick;
            if (EntityNameIN == "")
            {
                EntityNameIN = sys.GetEntityName(EntityIDIN, EntityBriefIN);  
            }                      
            CompEntityTreeFBA1.EntityNameNavigate(EntityNameIN);
        }
        
        private void FormGetEntity_FormClosing(object sender, FormClosingEventArgs e)
        {
            EntityName   = CompEntityTreeFBA1.EntityName;  
            EntityID     = CompEntityTreeFBA1.EntityID; 
            EntityBrief  = sys.GetEntityBrief(EntityID);
        }
        
        private void EntityTree_SelectedEntity(object sender, SelectEntityEventArgs e)
        {
            this.DialogResult = System.Windows.Forms.DialogResult.OK;
            //EntityID = e.EntityID;
            //EntityName   = EntityTree.EntityName;  
            //EntityID     = EntityTree.EntityID; 
            //EntityBrief  = sys.GetEntityBrief(EntityID);
            Close();
        }
    }
}
