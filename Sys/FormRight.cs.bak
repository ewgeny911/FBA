
﻿/*
 * Создано в SharpDevelop.
 * Пользователь: Travin
 * Дата: 14.10.2017
 * Время: 11:39
 */
 
using System;
using System.Drawing;
using System.Windows.Forms;
namespace FBA
{      
    public partial class FormRight : FormSim
    {
        private string Operation  = "";
        private string RightID    = "0";
        private string RightName  = "";
        private string RightBrief = "";          
        public int StatusClose     = 0;
        
        public FormRight(string Operation, string RightID, string RightName, string RightBrief)
        {           
            InitializeComponent();                    
            this.Operation = Operation;
            this.RightID     = RightID;
            this.RightName   = RightName;
            this.RightBrief  = RightBrief;
            if (Operation != "Add") {
                tbID.Text     = RightID;               
                tbName.Text   = RightName;           
                tbBrief.Text  = RightBrief;
            }                        
        }
        
        private void BtnOkClick(object sender, EventArgs e)
        {
            StatusClose = 1;             
            string SQL = "";
            if (Operation == "Add")                     
                SQL = "INSERT INTO arhRight (EntityID, Name, Brief, DateCreate, DateChange) VALUES (102, '" + tbName.Text + "', '" + tbBrief.Text + "', " + sys.DateTimeCurrent() + ", " + sys.DateTimeCurrent() + ") ";                
                       
            if (Operation == "Edit") 
            {               
                SQL = "UPDATE arhRight SET " +
                "Name   = '" + tbName.Text + "'," +
                "Brief  = '" + tbBrief.Text + "'," +             
                "DateChange = " + sys.DateTimeCurrent() + " " +
                "WHERE ID = " + RightID;              
            }
            if (SQL != "") sys.Exec("Remote", SQL);
            Close();
        }
        
        private void BtnCancelClick(object sender, EventArgs e)
        {
          StatusClose = 2;
            Close();
        }
    }
}
