<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FBA. Платформа для построения бизнес-приложения.: Исходный файл SysConnect.cs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ruby_48.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FBA. Платформа для построения бизнес-приложения.
   &#160;<span id="projectnumber">версия 1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Создано системой Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Поиск');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Поиск');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SysConnect.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_sys_connect_8cs.html">См. документацию.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;﻿<span class="comment">/* </span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Создано в SharpDevelop.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Пользователь: Травин</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Дата: 25.08.2017</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Время: 23:49</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">*/</span>    </div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">using</span> <a class="code" href="_sys_money_8cs.html#a81a223a02c34d82b47199f08308847f2">System</a>;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Linq;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Reflection;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Windows.Forms;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.IO;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Data;  </div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Security.Cryptography;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Text;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Collections.Generic;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Data.SqlClient;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_npgsql.html">Npgsql</a>;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Data.SQLite;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Drawing;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Runtime.Serialization.Json;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.CodeDom.Compiler;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">using</span> Microsoft.CSharp;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Collections;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//using Microsoft.Office.Interop.Excel; //Для экспорта в Excel</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Runtime.InteropServices; <span class="comment">//Для экспорта в Excel</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Deployment.Application;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Text.RegularExpressions;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//using FastColoredTextBoxNS;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//using Npgsql.BulkCopy;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//using Npgsql.BulkCopy.Native;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//using Npgsql.BulkCopy.Native.Versions;      </span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Net;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Net.Sockets;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_fast_colored_text_box_n_s.html">FastColoredTextBoxNS</a>; </div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Diagnostics;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Xml;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Runtime.Serialization.Formatters.Binary;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Threading.Tasks;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//using SourceGrid;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_f_b_a.html">FBA</a></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{                </div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    </div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html">   49</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_f_b_a_1_1_connection.html">Connection</a></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    {           </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">        #region Объявления</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        List&lt;<a class="code" href="namespace_system.html">System</a>.Data.DataTable&gt; dtRtn = <span class="keyword">new</span> List&lt;<a class="code" href="namespace_system.html">System</a>.Data.DataTable&gt;();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        </div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#ad362a30163e3a237460e0d5b2cb124d2">   58</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#ad362a30163e3a237460e0d5b2cb124d2">ConnectionID</a>   = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        </div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#ae89cedd48e08f769139faa24d29941aa">   63</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span>   <a class="code" href="class_f_b_a_1_1_connection.html#ae89cedd48e08f769139faa24d29941aa">ConnectionActive</a> = <span class="keyword">false</span>; </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        </div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a7e224aeb6f3f7aa7fa641f2bd9330520">   68</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span>   <a class="code" href="class_f_b_a_1_1_connection.html#a7e224aeb6f3f7aa7fa641f2bd9330520">ConnectionDirect</a> = <span class="keyword">false</span>; </div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a3cd37446a3a7203f48d984526b4849e5">   76</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a3cd37446a3a7203f48d984526b4849e5">ConnectionGUID</a> = <span class="stringliteral">&quot;&quot;</span>;      </div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                                </div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        </div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#ad06450c04a115c5f49848d0bc861b63e">   82</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#ad06450c04a115c5f49848d0bc861b63e">Name</a>           = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        </div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#aae6e7e372a0df905fdbe5ae1844d3279">   87</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#aae6e7e372a0df905fdbe5ae1844d3279">ConnectionName</a> = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        </div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">   92</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">ServerName</a>     = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;               </div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">   97</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a> <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>;     </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        </div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        </div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#ada46cb57e3fc2bea5b69c026d2eba248">  106</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a> <a class="code" href="class_f_b_a_1_1_connection.html#ada46cb57e3fc2bea5b69c026d2eba248">serverTypeRemote</a> = <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.NotAssigned;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                </div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a7af426539c14090db733c18b37cfc1f5">  111</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a7af426539c14090db733c18b37cfc1f5">DatabaseName</a>   = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        </div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#aa20952e5caba14009de078611bffc06e">  116</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#aa20952e5caba14009de078611bffc06e">DatabaseLogin</a>  = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        </div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#afb9f211ad33869d0d3ff480a8593cba0">  121</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#afb9f211ad33869d0d3ff480a8593cba0">DatabasePass</a>   = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a6ce212094097c98af886a3417b1510cc">  126</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a6ce212094097c98af886a3417b1510cc">UserForm</a>       = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        </div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a4da6cc26b934f060dc0c3ca79e9791d0">  131</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a4da6cc26b934f060dc0c3ca79e9791d0">UserLogin</a>      = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        </div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a9b58e4b1c4ca9af6571431806c0e17a9">  136</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a9b58e4b1c4ca9af6571431806c0e17a9">UserPass</a>       = <span class="stringliteral">&quot;&quot;</span>;     </div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a24c27a6a036bb03da1bbe1cdd29b1f16">  141</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a24c27a6a036bb03da1bbe1cdd29b1f16">ServerAppIP</a>    = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        </div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#af8d3357489e91efcf98ebf7b56110348">  146</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#af8d3357489e91efcf98ebf7b56110348">ServerAppName</a>  = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        </div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a556479c8ba68bce8cee63c53e8583c14">  151</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">int</span>    <a class="code" href="class_f_b_a_1_1_connection.html#a556479c8ba68bce8cee63c53e8583c14">ServerAppPort</a>  = 0;  </div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        </div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a3f41df8459a0eaf38857a233720dd1d0">  156</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a3f41df8459a0eaf38857a233720dd1d0">WindowsLogin</a>   = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        </div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> DatabaseLoginDecrypt      = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> DatabasePassDecrypt       = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> ConnectStringMSSQL        = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> ConnectStringPostgre     = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">string</span> ConnectStringSQLite       = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            </div><div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a11c6e4dac8775fc197a3b468dcff23cc">  168</a></span>&#160;        <span class="keyword">public</span> DateTime <a class="code" href="class_f_b_a_1_1_connection.html#a11c6e4dac8775fc197a3b468dcff23cc">LastQueryDateTime</a> = DateTime.Now;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                              </div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#ae4e944521bb94857288224ca9f20245a">  173</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_f_b_a_1_1_connection.html#ae4e944521bb94857288224ca9f20245a">Connection</a>()</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="comment">//</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        </div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a085fd480090159a0192a3cfdc2075574">  179</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_f_b_a_1_1_connection.html#a085fd480090159a0192a3cfdc2075574">Connection</a>(<a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a> <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>, <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">ServerName</a>, <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#aa20952e5caba14009de078611bffc06e">DatabaseLogin</a>, <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#afb9f211ad33869d0d3ff480a8593cba0">DatabasePass</a>, <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a7af426539c14090db733c18b37cfc1f5">DatabaseName</a>)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <a class="code" href="class_f_b_a_1_1_connection.html#a35e9a07c0120bdca37b4a7459b7e6a21">ConnectionInit</a>(<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>, <a class="code" href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">ServerName</a>, <a class="code" href="class_f_b_a_1_1_connection.html#aa20952e5caba14009de078611bffc06e">DatabaseLogin</a>, <a class="code" href="class_f_b_a_1_1_connection.html#afb9f211ad33869d0d3ff480a8593cba0">DatabasePass</a>, <a class="code" href="class_f_b_a_1_1_connection.html#a7af426539c14090db733c18b37cfc1f5">DatabaseName</a>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">        #endregion</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">        #region Инициализация: InitConnection, CloseConnection               </span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;               </div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a226d4baf3be0676551817c1ae46fbaa9">  192</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a226d4baf3be0676551817c1ae46fbaa9">ConnectionSetLocal</a>()</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        {                         </div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            FBAFile.GetPathSQLite(out <a class="code" href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">ServerName</a>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="comment">//return ConnectionInit(ServerType.SQLite, ServerName, &quot;&quot;, &quot;&quot;, &quot;&quot;);    </span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>    = <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.SQLite;  </div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <a class="code" href="class_f_b_a_1_1_connection.html#ad362a30163e3a237460e0d5b2cb124d2">ConnectionID</a> = <span class="stringliteral">&quot;0&quot;</span>;            </div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="class_f_b_a_1_1_connection.html#aa20952e5caba14009de078611bffc06e">DatabaseLogin</a> = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <a class="code" href="class_f_b_a_1_1_connection.html#afb9f211ad33869d0d3ff480a8593cba0">DatabasePass</a>  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <a class="code" href="class_f_b_a_1_1_connection.html#a7af426539c14090db733c18b37cfc1f5">DatabaseName</a>  = <span class="stringliteral">&quot;&quot;</span>;  </div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">return</span> ConnectionInitDataBase();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="comment">//if  (Var.con != null) serverType = Var.con.serverTypeRemote;</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="comment">//  else serverType = ServerType.Postgre;             </span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a35e9a07c0120bdca37b4a7459b7e6a21">  215</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a35e9a07c0120bdca37b4a7459b7e6a21">ConnectionInit</a>(<a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a> <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>, <span class="keywordtype">string</span> serverName, <span class="keywordtype">string</span> databaseLogin, <span class="keywordtype">string</span> databasePass, <span class="keywordtype">string</span> databaseName)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keywordflow">if</span> ((serverName == <span class="stringliteral">&quot;&quot;</span>) || (serverName == <span class="stringliteral">&quot;.&quot;</span>)) serverName = <span class="stringliteral">&quot;localhost&quot;</span>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="comment">//Разделяем имя сервера на имя и порт, если порт указан в имени серера через двоеточие. Пример: http://MyServer:9590</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="comment">//Если порта нет, то использует порт  по умолчанию 7100.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="comment">//if ((serverType == ServerType.MSSQL) || (serverType == ServerType.Postgre)) </span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            sys.GetServerAppPort(serverName, out <a class="code" href="class_f_b_a_1_1_connection.html#af8d3357489e91efcf98ebf7b56110348">ServerAppName</a>, out <a class="code" href="class_f_b_a_1_1_connection.html#a556479c8ba68bce8cee63c53e8583c14">ServerAppPort</a>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            </div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">if</span> (((serverName == <span class="stringliteral">&quot;localhost&quot;</span>) || (serverName == <span class="stringliteral">&quot;&quot;</span>)) &amp;&amp; (<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.SQLite)) </div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                FBAFile.GetPathSQLite(out serverName);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            this.serverType    = <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>;            </div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            this.ServerName    = serverName;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            this.DatabaseLogin = databaseLogin;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            this.DatabasePass  = databasePass;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            this.DatabaseName  = databaseName;            </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.ServerApp) </div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            {               </div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="keywordflow">return</span> ConnectionInitApp();</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.MSSQL) || (<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.Postgre) || (<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.SQLite)) <span class="keywordflow">return</span> ConnectionInitDataBase();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }                      </div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;       </div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> ConnectionInitDataBase()  </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        {                                                                                         </div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="comment">//Далее только если подключение не через сервер приложений:</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            this.DatabaseLoginDecrypt = Crypto.DecryptAES(<a class="code" href="class_f_b_a_1_1_connection.html#aa20952e5caba14009de078611bffc06e">DatabaseLogin</a>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            this.DatabasePassDecrypt  = Crypto.DecryptAES(<a class="code" href="class_f_b_a_1_1_connection.html#afb9f211ad33869d0d3ff480a8593cba0">DatabasePass</a>);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                </div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.Postgre)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                    ConnectStringPostgre = <span class="stringliteral">&quot;Server=&quot;</span> + <a class="code" href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">ServerName</a> + <span class="stringliteral">&quot;;User Id=&quot;</span> + DatabaseLoginDecrypt + <span class="stringliteral">&quot;;Password=&quot;</span> + DatabasePassDecrypt + <span class="stringliteral">&quot;;Database=&quot;</span> + <a class="code" href="class_f_b_a_1_1_connection.html#a7af426539c14090db733c18b37cfc1f5">DatabaseName</a> + <span class="stringliteral">&quot;;&quot;</span>;            </div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    <a class="code" href="namespace_npgsql.html">Npgsql</a>.NpgsqlConnection connection1 = null;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                    connection1 = <span class="keyword">new</span> <a class="code" href="namespace_npgsql.html">Npgsql</a>.NpgsqlConnection(ConnectStringPostgre);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    connection1.Open();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            </div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.MSSQL)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#aa20952e5caba14009de078611bffc06e">DatabaseLogin</a> == <span class="stringliteral">&quot;&quot;</span>) ConnectStringMSSQL = <span class="stringliteral">@&quot;Data Source=&quot;</span> + <a class="code" href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">ServerName</a> + <span class="stringliteral">&quot;;Initial Catalog=&quot;</span> + <a class="code" href="class_f_b_a_1_1_connection.html#a7af426539c14090db733c18b37cfc1f5">DatabaseName</a> + <span class="stringliteral">&quot;;Integrated Security=True&quot;</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                      <span class="keywordflow">else</span> ConnectStringMSSQL = <span class="stringliteral">&quot;Server=&quot;</span> + <a class="code" href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">ServerName</a> + <span class="stringliteral">&quot;;User Id=&quot;</span> + DatabaseLoginDecrypt + <span class="stringliteral">&quot;;Password=&quot;</span> + DatabasePassDecrypt + <span class="stringliteral">&quot;;Database=&quot;</span> + <a class="code" href="class_f_b_a_1_1_connection.html#a7af426539c14090db733c18b37cfc1f5">DatabaseName</a> + <span class="stringliteral">&quot;;&quot;</span>; <span class="comment">//Connection Timeout=2;                                            </span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <a class="code" href="namespace_system.html">System</a>.Data.SqlClient.SqlConnection connection2;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    connection2 = <span class="keyword">new</span> <a class="code" href="namespace_system.html">System</a>.Data.SqlClient.SqlConnection(ConnectStringMSSQL);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    connection2.Open();</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.SQLite)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                {                                                                                                                                       </div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    <span class="keywordflow">if</span> ((sys.ErrorCheck(!File.Exists(<a class="code" href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">ServerName</a>), <span class="stringliteral">&quot;Не найден файл базы данных.&quot;</span>))) <span class="keywordflow">return</span> <span class="keyword">false</span>;                                        </div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    ConnectStringSQLite = <span class="stringliteral">@&quot;Data Source=&quot;</span> + <a class="code" href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">ServerName</a> + <span class="stringliteral">@&quot;;New=False;Version=3;&quot;</span>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    <a class="code" href="namespace_system.html">System</a>.Data.SQLite.SQLiteConnection connection;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    connection = <span class="keyword">new</span> <a class="code" href="namespace_system.html">System</a>.Data.SQLite.SQLiteConnection(ConnectStringSQLite);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    connection.Open();</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    <span class="comment">//connection3.BindFunction(CloseToSQLiteFunction.GetAttribute(), new CloseToSQLiteFunction());                              </span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <a class="code" href="class_f_b_a_1_1_connection.html#ada46cb57e3fc2bea5b69c026d2eba248">serverTypeRemote</a> = <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>;                                                                          </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                <a class="code" href="class_f_b_a_1_1_connection.html#ae89cedd48e08f769139faa24d29941aa">ConnectionActive</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                <a class="code" href="class_f_b_a_1_1_connection.html#a7e224aeb6f3f7aa7fa641f2bd9330520">ConnectionDirect</a> = <span class="keyword">true</span>;                 </div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            {  </div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                sys.SM(<span class="stringliteral">&quot;Ошибка подключения: &quot;</span> + e.Message + <span class="stringliteral">&quot; к серверу &quot;</span> + <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>.ToString());</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <a class="code" href="class_f_b_a_1_1_connection.html#ae89cedd48e08f769139faa24d29941aa">ConnectionActive</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <a class="code" href="class_f_b_a_1_1_connection.html#a7e224aeb6f3f7aa7fa641f2bd9330520">ConnectionDirect</a> = <span class="keyword">false</span>; </div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }                                                                                     </div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;       </div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> ConnectionInitApp()</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        {                                                                                                                                                                                                </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            {                 </div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keywordtype">string</span> commandStr = <span class="stringliteral">&quot;LocalIP=&quot;</span> + Var.LocalIP + <span class="stringliteral">&quot;;LocalPort=&quot;</span> + Var.LocalServerPort + <span class="stringliteral">&quot;;LocalHost=&quot;</span> + Var.LocalHost + <span class="stringliteral">&quot;;ComputerName=&quot;</span> + Var.ComputerName + <span class="stringliteral">&quot;;ComputerUserName=&quot;</span> + Var.ComputerUserName + <span class="stringliteral">&quot;;&quot;</span>;                </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <span class="keywordtype">string</span> requestStr = sys.ServerAppSendHTTPMessage(<span class="stringliteral">&quot;Client&quot;</span>, <a class="code" href="class_f_b_a_1_1_connection.html#af8d3357489e91efcf98ebf7b56110348">ServerAppName</a>, <a class="code" href="class_f_b_a_1_1_connection.html#a556479c8ba68bce8cee63c53e8583c14">ServerAppPort</a>, <a class="code" href="namespace_f_b_a.html#abb5a0756c159f22dc419a5fcf5b6f3b5">CommandCode</a>.C102, <span class="stringliteral">&quot;&quot;</span>, commandStr, <span class="stringliteral">&quot;&quot;</span>, 0);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <span class="keywordflow">if</span> (requestStr    == <span class="stringliteral">&quot;&quot;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;              </div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                </div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <span class="keywordtype">string</span> direct;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="keywordtype">string</span> serverTypeLocal = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                ParseResponse(requestStr,</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                              out <a class="code" href="class_f_b_a_1_1_connection.html#a3cd37446a3a7203f48d984526b4849e5">ConnectionGUID</a>,</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                              out direct,</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                              out <a class="code" href="class_f_b_a_1_1_connection.html#aae6e7e372a0df905fdbe5ae1844d3279">ConnectionName</a>,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                              out <a class="code" href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">ServerName</a>,</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                              out serverTypeLocal,</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                              out <a class="code" href="class_f_b_a_1_1_connection.html#a7af426539c14090db733c18b37cfc1f5">DatabaseName</a>,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                              out <a class="code" href="class_f_b_a_1_1_connection.html#aa20952e5caba14009de078611bffc06e">DatabaseLogin</a>,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                              out <a class="code" href="class_f_b_a_1_1_connection.html#afb9f211ad33869d0d3ff480a8593cba0">DatabasePass</a>,   </div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                              out <a class="code" href="class_f_b_a_1_1_connection.html#a6ce212094097c98af886a3417b1510cc">UserForm</a>,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                              out <a class="code" href="class_f_b_a_1_1_connection.html#a4da6cc26b934f060dc0c3ca79e9791d0">UserLogin</a>,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                              out <a class="code" href="class_f_b_a_1_1_connection.html#a9b58e4b1c4ca9af6571431806c0e17a9">UserPass</a>);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <span class="comment">//sys.SM(&quot;GetParamConnectionApp.RequestStr: &quot; + RequestStr);                                          </span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <span class="keywordflow">if</span> (direct        != <span class="stringliteral">&quot;&quot;</span>) <a class="code" href="class_f_b_a_1_1_connection.html#a7e224aeb6f3f7aa7fa641f2bd9330520">ConnectionDirect</a> = Convert.ToBoolean(direct);          </div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keywordflow">if</span> (serverTypeLocal == <span class="stringliteral">&quot;MSSQL&quot;</span>)   <a class="code" href="class_f_b_a_1_1_connection.html#ada46cb57e3fc2bea5b69c026d2eba248">serverTypeRemote</a> = <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.MSSQL;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <span class="keywordflow">if</span> (serverTypeLocal == <span class="stringliteral">&quot;Postgre&quot;</span>) <a class="code" href="class_f_b_a_1_1_connection.html#ada46cb57e3fc2bea5b69c026d2eba248">serverTypeRemote</a> = <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.Postgre;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                <span class="keywordflow">if</span> (serverTypeLocal == <span class="stringliteral">&quot;SQLite&quot;</span>)  <a class="code" href="class_f_b_a_1_1_connection.html#ada46cb57e3fc2bea5b69c026d2eba248">serverTypeRemote</a> = <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.SQLite;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="class_f_b_a_1_1_connection.html#a7e224aeb6f3f7aa7fa641f2bd9330520">ConnectionDirect</a>) </div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    <span class="comment">//Все запросы через сервер приложений.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                    <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> = <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.ServerApp;                  </div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    <a class="code" href="class_f_b_a_1_1_connection.html#ae89cedd48e08f769139faa24d29941aa">ConnectionActive</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;              </div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <span class="comment">//Подключение напрямую к БД. Сервер приложений далее не участвует в подключении. </span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> = <a class="code" href="class_f_b_a_1_1_connection.html#ada46cb57e3fc2bea5b69c026d2eba248">serverTypeRemote</a>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <span class="keywordflow">if</span> (!ConnectionInitDataBase())  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                     </div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="comment">//Сервер приложений вернул настройки подключения напрямую к БД, и мы подключились нормально.                            </span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;                                        </div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordflow">catch</span> (Exception ex)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            { </div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                sys.SM(<span class="stringliteral">&quot;Ошибка обращения к серверу приложений &quot;</span> + <a class="code" href="class_f_b_a_1_1_connection.html#af8d3357489e91efcf98ebf7b56110348">ServerAppName</a> + <span class="stringliteral">&quot;:&quot;</span> + <a class="code" href="class_f_b_a_1_1_connection.html#a556479c8ba68bce8cee63c53e8583c14">ServerAppPort</a>.ToString() + <span class="stringliteral">&quot;: &quot;</span> + ex.Message);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <span class="comment">/*ConnectionGUID            = &quot;&quot;;</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">                ConnectionName  = &quot;&quot;;</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">                ServerName      = &quot;&quot;;</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">                ServerType      = &quot;&quot;;</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">                DatabaseName    = &quot;&quot;;</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">                DatabaseLogin   = &quot;&quot;;</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">                DatabasePass    = &quot;&quot;;</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">                UserForm        = &quot;&quot;;</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">                UserLogin       = &quot;&quot;;</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">                UserPass        = &quot;&quot;; */</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            }                                                                                        </div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      </div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> ParseResponse(<span class="keywordtype">string</span> requestStr, </div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                            out <span class="keywordtype">string</span> guid,</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                            out <span class="keywordtype">string</span> connectionDirect,    </div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                            out <span class="keywordtype">string</span> connectionName,</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                            out <span class="keywordtype">string</span> serverName,</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                            out <span class="keywordtype">string</span> serverTypeL,</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                            out <span class="keywordtype">string</span> databaseName,</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                            out <span class="keywordtype">string</span> databaseLogin,</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                            out <span class="keywordtype">string</span> databasePass,   </div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                            out <span class="keywordtype">string</span> userForm,</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                            out <span class="keywordtype">string</span> userLogin,</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                            out <span class="keywordtype">string</span> userPass)                       </div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        {                                                                      </div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            guid             = sys.StrBetweenStr(requestStr, <span class="stringliteral">&quot;GUID=&quot;</span>,           <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            connectionDirect = sys.StrBetweenStr(requestStr, <span class="stringliteral">&quot;ConnectionDirect=&quot;</span>, <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            connectionName   = sys.StrBetweenStr(requestStr, <span class="stringliteral">&quot;ConnectionName=&quot;</span>, <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            serverName       = sys.StrBetweenStr(requestStr, <span class="stringliteral">&quot;ServerName=&quot;</span>,     <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            serverTypeL      = sys.StrBetweenStr(requestStr, <span class="stringliteral">&quot;ServerType=&quot;</span>,     <span class="stringliteral">&quot;;&quot;</span>);            </div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            databaseName     = sys.StrBetweenStr(requestStr, <span class="stringliteral">&quot;DatabaseName=&quot;</span>,   <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            databaseLogin    = sys.StrBetweenStr(requestStr, <span class="stringliteral">&quot;DatabaseLogin=&quot;</span>,  <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            databasePass     = sys.StrBetweenStr(requestStr, <span class="stringliteral">&quot;DatabasePass=&quot;</span>,   <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            userForm         = sys.StrBetweenStr(requestStr, <span class="stringliteral">&quot;UserForm=&quot;</span>,       <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            userLogin        = sys.StrBetweenStr(requestStr, <span class="stringliteral">&quot;UserLogin=&quot;</span>,      <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            userPass         = sys.StrBetweenStr(requestStr, <span class="stringliteral">&quot;UserPass=&quot;</span>,       <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                 </div><div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a9f13d1affbfe468eeaca4daffa9b21d1">  416</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a9f13d1affbfe468eeaca4daffa9b21d1">ConnectionGetParamName</a>(                                     </div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                     <span class="keywordtype">string</span> connectionName, </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                     out <span class="keywordtype">string</span> connectionID,</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                     out <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>, </div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                     out <span class="keywordtype">string</span> serverName,                                     </div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                     out <span class="keywordtype">string</span> databaseName,</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                     out <span class="keywordtype">string</span> databaseLogin,</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                     out <span class="keywordtype">string</span> databasePass,</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                     out <span class="keywordtype">string</span> userForm,</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                     out <span class="keywordtype">string</span> userLogin,</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                     out <span class="keywordtype">string</span> userPass,</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                     out <span class="keywordtype">string</span> windowsLogin</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                     )</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        {                                                 </div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            connectionID  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>    = <span class="stringliteral">&quot;&quot;</span>; </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            serverName    = <span class="stringliteral">&quot;&quot;</span>;           </div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            databaseName  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            databaseLogin = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            databasePass  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            userForm      = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            userLogin     = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            userPass      = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            windowsLogin  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordflow">if</span> (sys.ErrorCheck(connectionName == <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Cоединение не выбрано!&quot;</span>)) <span class="keywordflow">return</span> <span class="keyword">false</span>;         </div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordtype">string</span> sql = <span class="stringliteral">&quot;SELECT ID, ServerType, ServerName, DatabaseName, DatabaseLogin, DatabasePass, UserForm, UserLogin, UserPass, WindowsLogin FROM fbaConList WHERE ConnectionName = &#39;&quot;</span> + connectionName + <span class="stringliteral">&quot;&#39; &quot;</span>; </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <a class="code" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">GetValue10</a>(sql, out connectionID,  out <a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>, out serverName, out databaseName, out databaseLogin, out databasePass, out userForm, out userLogin, out userPass, out windowsLogin);                                                                  </div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        }   </div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                </div><div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a766238aedcab93fcd7d4836db4550e31">  450</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a766238aedcab93fcd7d4836db4550e31">ConnectionClose</a>()</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            {               </div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.Postgre))</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                {          </div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    <a class="code" href="namespace_npgsql.html">Npgsql</a>.NpgsqlConnection.ClearAllPools();</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                    <a class="code" href="class_f_b_a_1_1_connection.html#ae89cedd48e08f769139faa24d29941aa">ConnectionActive</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.MSSQL))</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                {         </div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    <a class="code" href="namespace_system.html">System</a>.Data.SqlClient.SqlConnection.ClearAllPools();</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    <a class="code" href="class_f_b_a_1_1_connection.html#ae89cedd48e08f769139faa24d29941aa">ConnectionActive</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.SQLite))</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                {             </div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                    <a class="code" href="namespace_system.html">System</a>.Data.SQLite.SQLiteConnection.ClearAllPools();</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    <a class="code" href="class_f_b_a_1_1_connection.html#ae89cedd48e08f769139faa24d29941aa">ConnectionActive</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <a class="code" href="class_f_b_a_1_1_connection.html#ae89cedd48e08f769139faa24d29941aa">ConnectionActive</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                sys.SM(<span class="stringliteral">&quot;Ошибка закрытия соединения с БД: &quot;</span> + e.Message);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            }</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        }     </div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;               </div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor">        #endregion</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;       </div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">        #region Получение данных: GetValue, InsertDT, SelectDT, GetRefCursorData, SaveFileToDataBase, ReadFileFromDataBase                                        </span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        </div><div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a9d5433bfc95420f963f932439dd5a838">  491</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a9d5433bfc95420f963f932439dd5a838">GetValue</a>(<span class="keywordtype">string</span> sql)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <span class="keywordtype">string</span> s1;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="keywordtype">string</span> s2;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordtype">string</span> s3;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="keywordtype">string</span> s4;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordtype">string</span> s5;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordtype">string</span> s6;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keywordtype">string</span> s7;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keywordtype">string</span> s8;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordtype">string</span> s9;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordtype">string</span> s10;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordtype">bool</span> Result = <a class="code" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">GetValue10</a>(sql, out s1, out s2, out s3, out s4, out s5, out s6, out s7, out s8, out s9, out s10);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keywordflow">if</span> (Result) <span class="keywordflow">return</span> s1;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        </div><div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a01944c325a50484e95d952ac35445380">  515</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a01944c325a50484e95d952ac35445380">GetValue2</a>(<span class="keywordtype">string</span> sql, out <span class="keywordtype">string</span> s1, out <span class="keywordtype">string</span> s2)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="keywordtype">string</span> s3;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <span class="keywordtype">string</span> s4;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="keywordtype">string</span> s5;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="keywordtype">string</span> s6;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="keywordtype">string</span> s7;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordtype">string</span> s8;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordtype">string</span> s9;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="keywordtype">string</span> s10;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">GetValue10</a>(sql, out s1, out s2, out s3, out s4, out s5, out s6, out s7, out s8, out s9, out s10);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        </div><div class="line"><a name="l00536"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#abeada204d24cae01cbf5f73e0b505e99">  536</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#abeada204d24cae01cbf5f73e0b505e99">GetValue3</a>(<span class="keywordtype">string</span> sql, out <span class="keywordtype">string</span> s1, out <span class="keywordtype">string</span> s2, out <span class="keywordtype">string</span> s3)</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="keywordtype">string</span> s4;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="keywordtype">string</span> s5;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="keywordtype">string</span> s6;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="keywordtype">string</span> s7;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordtype">string</span> s8;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="keywordtype">string</span> s9;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordtype">string</span> s10;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">GetValue10</a>(sql, out s1, out s2, out s3, out s4, out s5, out s6, out s7, out s8, out s9, out s10);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        }        </div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        </div><div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a99f3a0c81f814bb49d075ea382e51b71">  557</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a99f3a0c81f814bb49d075ea382e51b71">GetValue4</a>(<span class="keywordtype">string</span> sql, out <span class="keywordtype">string</span> s1, out <span class="keywordtype">string</span> s2, out <span class="keywordtype">string</span> s3, out <span class="keywordtype">string</span> s4)</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="keywordtype">string</span> s5;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keywordtype">string</span> s6;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <span class="keywordtype">string</span> s7;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordtype">string</span> s8;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="keywordtype">string</span> s9;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <span class="keywordtype">string</span> s10;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">GetValue10</a>(sql, out s1, out s2, out s3, out s4, out s5, out s6, out s7, out s8, out s9, out s10);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        } </div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        </div><div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#ab11d0b86feaf69fbb49846f4537145ce">  578</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#ab11d0b86feaf69fbb49846f4537145ce">GetValue5</a>(<span class="keywordtype">string</span> sql, out <span class="keywordtype">string</span> s1, out <span class="keywordtype">string</span> s2, out <span class="keywordtype">string</span> s3, out <span class="keywordtype">string</span> s4, out <span class="keywordtype">string</span> s5)</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="keywordtype">string</span> s6;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="keywordtype">string</span> s7;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keywordtype">string</span> s8;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keywordtype">string</span> s9;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="keywordtype">string</span> s10;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">GetValue10</a>(sql, out s1, out s2, out s3, out s4, out s5, out s6, out s7, out s8, out s9, out s10);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;       } </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        </div><div class="line"><a name="l00599"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a50231c21a05c72ecab89a5b347941462">  599</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a50231c21a05c72ecab89a5b347941462">GetValue6</a>(<span class="keywordtype">string</span> sql, out <span class="keywordtype">string</span> s1, out <span class="keywordtype">string</span> s2, out <span class="keywordtype">string</span> s3, out <span class="keywordtype">string</span> s4, out <span class="keywordtype">string</span> s5, out <span class="keywordtype">string</span> s6)</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="keywordtype">string</span> s7;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordtype">string</span> s8;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordtype">string</span> s9;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="keywordtype">string</span> s10;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">GetValue10</a>(sql, out s1, out s2, out s3, out s4, out s5, out s6, out s7, out s8, out s9, out s10);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        }</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        </div><div class="line"><a name="l00620"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a220dc571237011f2e0afddd935cacd6d">  620</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a220dc571237011f2e0afddd935cacd6d">GetValue7</a>(<span class="keywordtype">string</span> sql, out <span class="keywordtype">string</span> s1, out <span class="keywordtype">string</span> s2, out <span class="keywordtype">string</span> s3, out <span class="keywordtype">string</span> s4, out <span class="keywordtype">string</span> s5, out <span class="keywordtype">string</span> s6, out <span class="keywordtype">string</span> s7)</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="keywordtype">string</span> s8;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <span class="keywordtype">string</span> s9;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordtype">string</span> s10;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">GetValue10</a>(sql, out s1, out s2, out s3, out s4, out s5, out s6, out s7, out s8, out s9, out s10);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        }  </div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        </div><div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a79f620faffaf2bc26837bfe8d4ef368b">  641</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a79f620faffaf2bc26837bfe8d4ef368b">GetValue8</a>(<span class="keywordtype">string</span> sql, out <span class="keywordtype">string</span> s1, out <span class="keywordtype">string</span> s2, out <span class="keywordtype">string</span> s3, out <span class="keywordtype">string</span> s4, out <span class="keywordtype">string</span> s5, out <span class="keywordtype">string</span> s6, out <span class="keywordtype">string</span> s7, out <span class="keywordtype">string</span> s8)</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordtype">string</span> s9;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="keywordtype">string</span> s10;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">GetValue10</a>(sql, out s1, out s2, out s3, out s4, out s5, out s6, out s7, out s8, out s9, out s10);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        }        </div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    </div><div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a963bce9db48309a24f9e5360255f7f5e">  662</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a963bce9db48309a24f9e5360255f7f5e">GetValue9</a>(<span class="keywordtype">string</span> sql, out <span class="keywordtype">string</span> s1, out <span class="keywordtype">string</span> s2, out <span class="keywordtype">string</span> s3, out <span class="keywordtype">string</span> s4, out <span class="keywordtype">string</span> s5, out <span class="keywordtype">string</span> s6, out <span class="keywordtype">string</span> s7, out <span class="keywordtype">string</span> s8, out <span class="keywordtype">string</span> s9)</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="keywordtype">string</span> s10;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">GetValue10</a>(sql, out s1, out s2, out s3, out s4, out s5, out s6, out s7, out s8, out s9, out s10);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        </div><div class="line"><a name="l00683"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">  683</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">GetValue10</a>(<span class="keywordtype">string</span> sql, out <span class="keywordtype">string</span> s1, out <span class="keywordtype">string</span> s2, out <span class="keywordtype">string</span> s3, out <span class="keywordtype">string</span> s4, out <span class="keywordtype">string</span> s5, out <span class="keywordtype">string</span> s6, out <span class="keywordtype">string</span> s7, out <span class="keywordtype">string</span> s8, out <span class="keywordtype">string</span> s9, out <span class="keywordtype">string</span> s10)</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        {                    </div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            s1  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            s2  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            s3  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            s4  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            s5  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            s6  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            s7  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            s8  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            s9  = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            s10 = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keywordflow">if</span> ((sql == <span class="stringliteral">&quot;&quot;</span>) || (sql == <span class="stringliteral">&quot;Empty&quot;</span>)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            </div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            var dt = <span class="keyword">new</span> <a class="code" href="namespace_system.html">System</a>.Data.DataTable();</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <a class="code" href="class_f_b_a_1_1_connection.html#a17c79b7810deb7e632187a146a27d725">SelectDT</a>(sql, out dt);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            </div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            {                                                                                                </div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                <span class="comment">//LastQueryDateTime = DateTime.Now; </span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                <span class="keywordflow">if</span> (dt.Rows.Count &gt; 0)</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                    <span class="keywordflow">if</span> (dt.Columns.Count &gt; 0) s1  = dt.Rows[0][0].ToString();</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                    <span class="keywordflow">if</span> (dt.Columns.Count &gt; 1) s2  = dt.Rows[0][1].ToString();</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                    <span class="keywordflow">if</span> (dt.Columns.Count &gt; 2) s3  = dt.Rows[0][2].ToString();</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                    <span class="keywordflow">if</span> (dt.Columns.Count &gt; 3) s4  = dt.Rows[0][3].ToString();</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                    <span class="keywordflow">if</span> (dt.Columns.Count &gt; 4) s5  = dt.Rows[0][4].ToString();</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                    <span class="keywordflow">if</span> (dt.Columns.Count &gt; 5) s6  = dt.Rows[0][5].ToString();</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                    <span class="keywordflow">if</span> (dt.Columns.Count &gt; 6) s7  = dt.Rows[0][6].ToString();</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                    <span class="keywordflow">if</span> (dt.Columns.Count &gt; 7) s8  = dt.Rows[0][7].ToString();</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                    <span class="keywordflow">if</span> (dt.Columns.Count &gt; 8) s9  = dt.Rows[0][8].ToString();</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                    <span class="keywordflow">if</span> (dt.Columns.Count &gt; 9) s10 = dt.Rows[0][9].ToString();</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;  </div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                }</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;                            </div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            {               </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                <span class="keywordtype">string</span> errorMes = <span class="stringliteral">&quot;702. Ошибка выполнения запроса: &quot;</span> + Var.CR + e.Message + Var.CR + sql; </div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="comment">//if (ErrorShow) </span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                sys.SM(errorMes);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                dt = null;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;               </div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            }</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        }</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;         </div><div class="line"><a name="l00735"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a49b48dd82db1f15bdaa4ede9eab9c2cc">  735</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a49b48dd82db1f15bdaa4ede9eab9c2cc">GetValueArr</a>(<span class="keywordtype">string</span> sql, ref <span class="keywordtype">string</span>[] arr)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        {  </div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="keywordflow">if</span> ((sql == <span class="stringliteral">&quot;&quot;</span>) || (sql == <span class="stringliteral">&quot;Empty&quot;</span>)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            var dt = <span class="keyword">new</span> <a class="code" href="namespace_system.html">System</a>.Data.DataTable();</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <a class="code" href="class_f_b_a_1_1_connection.html#a17c79b7810deb7e632187a146a27d725">SelectDT</a>(sql, out dt);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            {             </div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <span class="keywordflow">if</span> (dt.Rows.Count == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dt.Columns.Count; i++)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    <span class="keywordflow">if</span> (i &lt; arr.Length) arr[i] = dt.Rows[0][i].ToString();</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                }    </div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;                             </div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                <span class="keywordtype">string</span> errorMes = <span class="stringliteral">&quot;7031. Ошибка выполнения запроса: &quot;</span> + Var.CR + e.Message + Var.CR + sql;               </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                sys.SM(errorMes);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                dt = null;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            }</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        }    </div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        </div><div class="line"><a name="l00764"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#ab741e12a89628ff1afe3aa50e019d836">  764</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#ab741e12a89628ff1afe3aa50e019d836">SelectGV</a>(<span class="keywordtype">string</span> sql, DataGridView grid)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        {                    </div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <a class="code" href="namespace_system.html">System</a>.Data.DataTable dt;                    </div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="class_f_b_a_1_1_connection.html#a17c79b7810deb7e632187a146a27d725">SelectDT</a>(sql, out dt)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            grid.DataSource = dt;                          </div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;           </div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        }                             </div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a17c79b7810deb7e632187a146a27d725">  778</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a17c79b7810deb7e632187a146a27d725">SelectDT</a>(<span class="keywordtype">string</span> sql, out <a class="code" href="namespace_system.html">System</a>.Data.DataTable dt)</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keywordtype">string</span> errorMes = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> errorShow = <span class="keyword">true</span>;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <a class="code" href="namespace_system.html">System</a>.Data.DataSet ds;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <span class="keywordtype">bool</span> result;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            result = <a class="code" href="class_f_b_a_1_1_connection.html#a05684a6c70de969923339bbaebe82f5f">SelectDS</a>(sql, out ds, out errorMes, errorShow);  </div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordflow">if</span> ((ds != null) &amp;&amp; (ds.Tables.Count &gt; 0))</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            {              </div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                dt = ds.Tables[0];                              </div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            } <span class="keywordflow">else</span>  dt = null;                              </div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            <span class="keywordflow">return</span> result;           </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        }   </div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    </div><div class="line"><a name="l00798"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a05684a6c70de969923339bbaebe82f5f">  798</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a05684a6c70de969923339bbaebe82f5f">SelectDS</a>(<span class="keywordtype">string</span> sql, out DataSet ds)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordtype">string</span> errorMes = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> errorShow = <span class="keyword">true</span>;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_f_b_a_1_1_connection.html#a05684a6c70de969923339bbaebe82f5f">SelectDS</a>(sql, out ds, out errorMes, errorShow);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        }</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#ae384f24ee6f026cd580a76202560445a">  813</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#ae384f24ee6f026cd580a76202560445a">SelectDS</a>(<span class="keywordtype">string</span> sql, out DataSet ds, out <span class="keywordtype">string</span> errorMes, <span class="keywordtype">bool</span> errorShow)</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        {           </div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            ds = <span class="keyword">new</span> DataSet(<span class="stringliteral">&quot;DS&quot;</span>);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            errorMes = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <span class="keywordflow">if</span> ((sys.IsEmpty(sql)) || (sql == <span class="stringliteral">&quot;Empty&quot;</span>)) <span class="keywordflow">return</span> <span class="keyword">false</span>;           </div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            {</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#a7e224aeb6f3f7aa7fa641f2bd9330520">ConnectionDirect</a>)</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                {</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> == <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.Postgre)</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                    {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                        <a class="code" href="namespace_npgsql.html">Npgsql</a>.NpgsqlConnection connection = null; <span class="comment">//Postgres</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                        connection = <span class="keyword">new</span> <a class="code" href="namespace_npgsql.html">Npgsql</a>.NpgsqlConnection(ConnectStringSQLite);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                        connection.Open();</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                        var da = <span class="keyword">new</span> NpgsqlDataAdapter(sql, connection);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                        da.Fill(ds);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                        connection.Close();</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                    }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> ==  <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.MSSQL)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                    {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                        var connection = <span class="keyword">new</span> <a class="code" href="namespace_system.html">System</a>.Data.SqlClient.SqlConnection(ConnectStringMSSQL);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                        connection.Open();</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                        var da = <span class="keyword">new</span> SqlDataAdapter(sql, connection);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                        da.Fill(ds);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                        connection.Close();</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                    }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                }</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;               </div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> ==  <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.SQLite)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                {                                      </div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                    var connection = <span class="keyword">new</span> <a class="code" href="namespace_system.html">System</a>.Data.SQLite.SQLiteConnection(ConnectStringSQLite);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    connection.Open();</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                    var da = <span class="keyword">new</span> SQLiteDataAdapter(sql, connection);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                    da.Fill(ds);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                    connection.Close();</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                    <span class="comment">//connection.BindFunction(CloseToSQLiteFunction.GetAttribute(), new CloseToSQLiteFunction());                              </span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="class_f_b_a_1_1_connection.html#a7e224aeb6f3f7aa7fa641f2bd9330520">ConnectionDirect</a>)</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                {</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    <span class="keywordflow">if</span> (!AppSelectDS(sql, out ds)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                }</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                <a class="code" href="class_f_b_a_1_1_connection.html#a11c6e4dac8775fc197a3b468dcff23cc">LastQueryDateTime</a> = DateTime.Now;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            {               </div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                errorMes = <span class="stringliteral">&quot;703. Ошибка выполнения запроса: &quot;</span> + errorMes + Var.CR + e.Message + Var.CR + sql; </div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                <span class="keywordflow">if</span> (errorShow) sys.SM(errorMes);                      </div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                ds = null;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;               </div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        }                                                        </div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                </div><div class="line"><a name="l00876"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a167e00898afa701230592d060c6d2e2c">  876</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a167e00898afa701230592d060c6d2e2c">GetInsertID</a>()</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        {   </div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#ada46cb57e3fc2bea5b69c026d2eba248">serverTypeRemote</a> ==  <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.Postgre) <span class="keywordflow">return</span> <span class="stringliteral">&quot;; RETURNING id; &quot;</span>;                     </div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#ada46cb57e3fc2bea5b69c026d2eba248">serverTypeRemote</a> ==  <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.MSSQL)   <span class="keywordflow">return</span> <span class="stringliteral">&quot;; SELECT @@IDENTITY AS id; &quot;</span>;                                          </div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#ada46cb57e3fc2bea5b69c026d2eba248">serverTypeRemote</a> ==  <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.SQLite)  <span class="keywordflow">return</span> <span class="stringliteral">&quot;; SELECT last_insert_rowid() AS id; &quot;</span>; </div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        }</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      </div><div class="line"><a name="l00889"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#aad46a834def484b00f7930ca4ec880be">  889</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#aad46a834def484b00f7930ca4ec880be">Exec</a>(<span class="keywordtype">string</span> sql)</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="keywordtype">string</span> ID;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_f_b_a_1_1_connection.html#aad46a834def484b00f7930ca4ec880be">Exec</a>(sql, <span class="keyword">false</span>, out ID);</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        }                             </div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        </div><div class="line"><a name="l00906"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#aa58e35746bf7d3176e982770ae60c83e">  906</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#aa58e35746bf7d3176e982770ae60c83e">Exec</a>(<span class="keywordtype">string</span> sql, <span class="keywordtype">bool</span> addInsertID, out <span class="keywordtype">string</span> <span class="keywordtype">id</span>)</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        {   </div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <span class="keywordtype">id</span> = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <span class="keywordflow">if</span> (addInsertID) sql += <a class="code" href="class_f_b_a_1_1_connection.html#a167e00898afa701230592d060c6d2e2c">GetInsertID</a>();</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <a class="code" href="namespace_system.html">System</a>.Data.DataTable dt;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="class_f_b_a_1_1_connection.html#a17c79b7810deb7e632187a146a27d725">SelectDT</a>(sql, out dt)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <span class="keywordflow">if</span> (dt != null) <span class="keywordtype">id</span> = dt.Value(<span class="stringliteral">&quot;id&quot;</span>);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        }                     </div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                         </div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="preprocessor">        #endregion             </span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;               </div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="preprocessor">        #region Работа с сервером приложений.</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;             </div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> AppSelectDS(<span class="keywordtype">string</span> sql, out <a class="code" href="namespace_system.html">System</a>.Data.DataSet ds)</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        {   </div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="keywordflow">return</span> AppQuery(<a class="code" href="namespace_f_b_a.html#ae3e8e3cf257baeeb6f393380f9abe802">TypeQuery</a>.SELECT, 1, sql, out ds);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;               </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> AppSelectDT(<span class="keywordtype">string</span> sql, out <a class="code" href="namespace_system.html">System</a>.Data.DataTable dt)</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        {   </div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <a class="code" href="namespace_system.html">System</a>.Data.DataSet ds;           </div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="keywordtype">bool</span> ResultQuery = AppQuery(<a class="code" href="namespace_f_b_a.html#ae3e8e3cf257baeeb6f393380f9abe802">TypeQuery</a>.SELECT, 1, sql, out ds);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="keywordflow">if</span> (ds.Tables.Count == 0) </div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            {</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                dt = null;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                <span class="keywordflow">return</span> ResultQuery;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            }</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            dt = ds.Tables[0];</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            <span class="keywordflow">return</span> ResultQuery;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        }</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                 </div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> AppQuery(<a class="code" href="namespace_f_b_a.html#ae3e8e3cf257baeeb6f393380f9abe802">TypeQuery</a> typeQuery, <span class="keywordtype">int</span> numQuery, <span class="keywordtype">string</span> sql, out <a class="code" href="namespace_system.html">System</a>.Data.DataSet ds)</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        {               </div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            ds = null;         </div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="class_f_b_a_1_1_connection.html#a3cd37446a3a7203f48d984526b4849e5">ConnectionGUID</a> == <span class="stringliteral">&quot;&quot;</span>) || (<a class="code" href="class_f_b_a_1_1_connection.html#af8d3357489e91efcf98ebf7b56110348">ServerAppName</a> == <span class="stringliteral">&quot;&quot;</span>))</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            {    </div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                sys.SM(<span class="stringliteral">&quot;Ошибка. соединение с сервером приложений не установлено!&quot;</span>);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            }  </div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            </div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <a class="code" href="namespace_f_b_a.html#abb5a0756c159f22dc419a5fcf5b6f3b5">CommandCode</a> commandCode = <a class="code" href="namespace_f_b_a.html#abb5a0756c159f22dc419a5fcf5b6f3b5">CommandCode</a>.C103;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <span class="keywordflow">if</span> (typeQuery == <a class="code" href="namespace_f_b_a.html#ae3e8e3cf257baeeb6f393380f9abe802">TypeQuery</a>.EXEC) commandCode = <a class="code" href="namespace_f_b_a.html#abb5a0756c159f22dc419a5fcf5b6f3b5">CommandCode</a>.C104; </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                        </div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <span class="keywordtype">string</span> requestStr = sys.ServerAppSendHTTPMessage(<span class="stringliteral">&quot;Client&quot;</span>, <a class="code" href="class_f_b_a_1_1_connection.html#af8d3357489e91efcf98ebf7b56110348">ServerAppName</a>, <a class="code" href="class_f_b_a_1_1_connection.html#a556479c8ba68bce8cee63c53e8583c14">ServerAppPort</a>, commandCode, <a class="code" href="class_f_b_a_1_1_connection.html#a3cd37446a3a7203f48d984526b4849e5">ConnectionGUID</a>, sql, <span class="stringliteral">&quot;&quot;</span>, 0);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            <span class="keywordflow">if</span> (requestStr == <span class="stringliteral">&quot;&quot;</span>) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            <span class="keywordflow">if</span> (requestStr.Left(3) == <a class="code" href="namespace_f_b_a.html#a5c9054908e699f0f81132622ba66a935">ErrorCode</a>.S501.ToString()) <span class="comment">//&quot;501. Ошибка. Сессия с сервером не найдена!&quot;)</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            {</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <span class="keywordflow">if</span> (numQuery &lt; 2) <span class="comment">//Переподключаемся только 1 раз, чтобы не зацикливаться.</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                {                       </div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                    <span class="keywordflow">if</span> (!(sys.Enter(<span class="keyword">this</span>.ConnectionName, Var.enterMode, Var.UserLogin, Var.UserPass)))</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                    {</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                        sys.SM(requestStr + Var.CR + <span class="stringliteral">&quot;Ошибка повторного входа в систему!&quot;</span>);</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                    }</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                    numQuery = numQuery + 1;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                    <span class="comment">//this.ConnectionGUID = NextConnectionGUID;</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                    <span class="comment">//Здесь важно именно писать Var.con.AppQuery, а не просто AppQuery, </span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                    <span class="comment">//для того, чтобы AppQuery выполнился в другом созданном con, </span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                    <span class="comment">//для того чтобы использовался ConnectionGUID уже другого con.</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                    <span class="comment">//то что SystemEnter возвращает ConnectionGUID ничего не меняет.</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                    <span class="comment">//Можно убрать возврат ConnectionGUID из SystemEnter - это ничего не изменит.</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                    Var.con.AppQuery(typeQuery, numQuery, sql, out ds);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                }               </div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                sys.SM(requestStr + Var.CR + <span class="stringliteral">&quot;Ошибка подключения к серверу приложений!&quot;</span>);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;               </div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            </div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <span class="keywordflow">if</span> (requestStr.Substring(0,1) == <span class="stringliteral">&quot;5&quot;</span>)</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            {</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                <span class="comment">//Все ошибки начинаются на 5:</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                sys.SM(requestStr);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            ds = sys.StrToDataSet(requestStr); </div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="comment">//LastQueryDateTime = DateTime.Now;            </span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;       </div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        }</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                </div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="preprocessor">        #endregion       </span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;         </div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="preprocessor">        #region Методы проверки и получения различных данных из БД.                             </span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                                             </div><div class="line"><a name="l01016"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a832beb0a31c62baefdb724e94537e97c"> 1016</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="class_f_b_a_1_1_connection.html#a832beb0a31c62baefdb724e94537e97c">SelectCount</a>(<span class="keywordtype">string</span> sql)</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        {                                 </div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;           <a class="code" href="namespace_system.html">System</a>.Data.DataTable dt;           </div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;           <span class="keywordflow">if</span> (!<a class="code" href="class_f_b_a_1_1_connection.html#a17c79b7810deb7e632187a146a27d725">SelectDT</a>(sql, out dt)) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;           <span class="keywordflow">return</span> dt.Rows.Count;          </div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        }               </div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        </div><div class="line"><a name="l01029"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#ab06c1ddb28525efd92457b44392378c4"> 1029</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#ab06c1ddb28525efd92457b44392378c4">SelectCB</a>(<span class="keywordtype">string</span> sql, ComboBox cb)</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <a class="code" href="namespace_system.html">System</a>.Data.DataTable dt;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            <span class="keywordtype">bool</span> flag = <a class="code" href="class_f_b_a_1_1_connection.html#a17c79b7810deb7e632187a146a27d725">SelectDT</a>(sql, out dt);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            cb.DataSource = dt;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            <span class="keywordflow">return</span> flag;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        }         </div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;     </div><div class="line"><a name="l01044"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a55e0e003b04b9ee54c49e47a6cebf0b4"> 1044</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_f_b_a_1_1_connection.html#a55e0e003b04b9ee54c49e47a6cebf0b4">GetServerDate</a>()</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        {      </div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <span class="keywordtype">string</span> sql = sys.SelectCurrentDateTime(<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>);</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_f_b_a_1_1_connection.html#a9d5433bfc95420f963f932439dd5a838">GetValue</a>(sql);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        }</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        </div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="preprocessor">        #endregion</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        </div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="preprocessor">        #region Region. Экспорт и импорт строки DataTable в файл/из файла. </span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                          </div><div class="line"><a name="l01060"></a><span class="lineno"><a class="line" href="class_f_b_a_1_1_connection.html#a2639fc83e1f04830b26312cdd19b5948"> 1060</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_f_b_a_1_1_connection.html#a2639fc83e1f04830b26312cdd19b5948">MSSQLCopyTableToServer</a>(<a class="code" href="namespace_system.html">System</a>.Data.DataTable dt, <span class="keywordtype">string</span> tableName)</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        {                           </div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a> != <a class="code" href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">ServerType</a>.MSSQL) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                <span class="keywordtype">string</span> sql = sys.GetTextCreateTable(<a class="code" href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">serverType</a>, tableName, dt);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                <a class="code" href="class_f_b_a_1_1_connection.html#aad46a834def484b00f7930ca4ec880be">Exec</a>(sql);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                var connection = <span class="keyword">new</span> <a class="code" href="namespace_system.html">System</a>.Data.SqlClient.SqlConnection(ConnectStringMSSQL);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                connection.Open();</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                var copy = <span class="keyword">new</span> SqlBulkCopy(connection);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                copy.DestinationTableName = tableName;            </div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                copy.WriteToServer(dt); </div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            } <span class="keywordflow">catch</span> (Exception ex)</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            {                               </div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                sys.SM(ex.Message);                     </div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;   </div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            }                       </div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        }  </div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;             </div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="preprocessor">        #endregion Region. Экспорт и импорт строки DataTable в файл/из файла.                  </span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    }</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;}</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">//public override int System.Data.Common.DbDataAdapter.Fill(DataSet dataSet);</span></div><div class="ttc" id="class_f_b_a_1_1_connection_html_a3f41df8459a0eaf38857a233720dd1d0"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a3f41df8459a0eaf38857a233720dd1d0">FBA.Connection.WindowsLogin</a></div><div class="ttdeci">string WindowsLogin</div><div class="ttdoc">Признак что авторизация через логин Windows. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00156">SysConnect.cs:156</a></div></div>
<div class="ttc" id="namespace_f_b_a_html_ae3e8e3cf257baeeb6f393380f9abe802"><div class="ttname"><a href="namespace_f_b_a.html#ae3e8e3cf257baeeb6f393380f9abe802">FBA.TypeQuery</a></div><div class="ttdeci">TypeQuery</div><div class="ttdoc">Тип запроса к серверу приложений: NotAssigned, SELECT, EXEC </div><div class="ttdef"><b>Definition:</b> <a href="_sys_static_8cs_source.html#l00876">SysStatic.cs:876</a></div></div>
<div class="ttc" id="namespace_npgsql_html"><div class="ttname"><a href="namespace_npgsql.html">Npgsql</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a2639fc83e1f04830b26312cdd19b5948"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a2639fc83e1f04830b26312cdd19b5948">FBA.Connection.MSSQLCopyTableToServer</a></div><div class="ttdeci">bool MSSQLCopyTableToServer(System.Data.DataTable dt, string tableName)</div><div class="ttdoc">Копирование таблицы DataTable на сервер MSSQL. Для SQLite и Postrgres нужно действовать через создани...</div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l01060">SysConnect.cs:1060</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a35e9a07c0120bdca37b4a7459b7e6a21"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a35e9a07c0120bdca37b4a7459b7e6a21">FBA.Connection.ConnectionInit</a></div><div class="ttdeci">bool ConnectionInit(ServerType serverType, string serverName, string databaseLogin, string databasePass, string databaseName)</div><div class="ttdoc">Соединение с БД </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00215">SysConnect.cs:215</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_ada46cb57e3fc2bea5b69c026d2eba248"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#ada46cb57e3fc2bea5b69c026d2eba248">FBA.Connection.serverTypeRemote</a></div><div class="ttdeci">ServerType serverTypeRemote</div><div class="ttdoc">Это тип удаленного подключения, если соединение через сервер приложений. Если подключение к БД локаль...</div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00106">SysConnect.cs:106</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_abeada204d24cae01cbf5f73e0b505e99"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#abeada204d24cae01cbf5f73e0b505e99">FBA.Connection.GetValue3</a></div><div class="ttdeci">bool GetValue3(string sql, out string s1, out string s2, out string s3)</div><div class="ttdoc">Получение 3-х значений. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00536">SysConnect.cs:536</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a832beb0a31c62baefdb724e94537e97c"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a832beb0a31c62baefdb724e94537e97c">FBA.Connection.SelectCount</a></div><div class="ttdeci">int SelectCount(string sql)</div><div class="ttdoc">Возвращает количество записей, которые получаются после выполнения запроса SQL. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l01016">SysConnect.cs:1016</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a05684a6c70de969923339bbaebe82f5f"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a05684a6c70de969923339bbaebe82f5f">FBA.Connection.SelectDS</a></div><div class="ttdeci">bool SelectDS(string sql, out DataSet ds)</div><div class="ttdoc">Функция получения данных для MSSQL, Postgre, SQLite. Результат в DataSet. Возвращает несколько таблиц...</div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00798">SysConnect.cs:798</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_aa58e35746bf7d3176e982770ae60c83e"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#aa58e35746bf7d3176e982770ae60c83e">FBA.Connection.Exec</a></div><div class="ttdeci">bool Exec(string sql, bool addInsertID, out string id)</div><div class="ttdoc">Выполнить запрос SQL </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00906">SysConnect.cs:906</a></div></div>
<div class="ttc" id="namespace_f_b_a_html_a5c9054908e699f0f81132622ba66a935"><div class="ttname"><a href="namespace_f_b_a.html#a5c9054908e699f0f81132622ba66a935">FBA.ErrorCode</a></div><div class="ttdeci">ErrorCode</div><div class="ttdoc">Все возможные типы ошибок. C - что это ошибка на клиенте. S - на сервере </div><div class="ttdef"><b>Definition:</b> <a href="_sys_static_8cs_source.html#l00657">SysStatic.cs:657</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a55e0e003b04b9ee54c49e47a6cebf0b4"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a55e0e003b04b9ee54c49e47a6cebf0b4">FBA.Connection.GetServerDate</a></div><div class="ttdeci">string GetServerDate()</div><div class="ttdoc">Текущая дата на сервере. Postgre = SELECT current_timestamp AS CurrentDateTime  MSSQL = SELECT dateti...</div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l01044">SysConnect.cs:1044</a></div></div>
<div class="ttc" id="namespace_f_b_a_html_a54b34d51226fe01d01f79d9fcb237413"><div class="ttname"><a href="namespace_f_b_a.html#a54b34d51226fe01d01f79d9fcb237413">FBA.ServerType</a></div><div class="ttdeci">ServerType</div><div class="ttdoc">Все поддерживаемые сервера: NotAssigned, MSSQL, Postgre, SQLite, ServerApp, Auto </div><div class="ttdef"><b>Definition:</b> <a href="_sys_static_8cs_source.html#l00839">SysStatic.cs:839</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a11c6e4dac8775fc197a3b468dcff23cc"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a11c6e4dac8775fc197a3b468dcff23cc">FBA.Connection.LastQueryDateTime</a></div><div class="ttdeci">DateTime LastQueryDateTime</div><div class="ttdoc">Дата и время последнего запроса. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00168">SysConnect.cs:168</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a6a04e4e09b3be5fc37491234ccf46a61"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a6a04e4e09b3be5fc37491234ccf46a61">FBA.Connection.ServerName</a></div><div class="ttdeci">string ServerName</div><div class="ttdoc">Имя сервера СУБД. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00092">SysConnect.cs:92</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_ab741e12a89628ff1afe3aa50e019d836"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#ab741e12a89628ff1afe3aa50e019d836">FBA.Connection.SelectGV</a></div><div class="ttdeci">bool SelectGV(string sql, DataGridView grid)</div><div class="ttdoc">Функции получения данных для MSSQL, Postgre, SQLite. Результат в DataGridView.  </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00764">SysConnect.cs:764</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_aae6e7e372a0df905fdbe5ae1844d3279"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#aae6e7e372a0df905fdbe5ae1844d3279">FBA.Connection.ConnectionName</a></div><div class="ttdeci">string ConnectionName</div><div class="ttdoc">Имя соединения в локальной базе SQLite.  </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00087">SysConnect.cs:87</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_ad5c6e7969020c242db56e1910c6e353f"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#ad5c6e7969020c242db56e1910c6e353f">FBA.Connection.serverType</a></div><div class="ttdeci">ServerType serverType</div><div class="ttdoc">Допустимые значения: MSSQL, Postgre, SQLite, ServerApp. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00097">SysConnect.cs:97</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a24c27a6a036bb03da1bbe1cdd29b1f16"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a24c27a6a036bb03da1bbe1cdd29b1f16">FBA.Connection.ServerAppIP</a></div><div class="ttdeci">string ServerAppIP</div><div class="ttdoc">IP сервера приложений. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00141">SysConnect.cs:141</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_aad46a834def484b00f7930ca4ec880be"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#aad46a834def484b00f7930ca4ec880be">FBA.Connection.Exec</a></div><div class="ttdeci">bool Exec(string sql)</div><div class="ttdoc">Выполнить запрос SQL. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00889">SysConnect.cs:889</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a01944c325a50484e95d952ac35445380"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a01944c325a50484e95d952ac35445380">FBA.Connection.GetValue2</a></div><div class="ttdeci">bool GetValue2(string sql, out string s1, out string s2)</div><div class="ttdoc">Получение 2-х значений. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00515">SysConnect.cs:515</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_ae384f24ee6f026cd580a76202560445a"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#ae384f24ee6f026cd580a76202560445a">FBA.Connection.SelectDS</a></div><div class="ttdeci">bool SelectDS(string sql, out DataSet ds, out string errorMes, bool errorShow)</div><div class="ttdoc">Функция получения данных для MSSQL, Postgre, SQLite. Результат в DataSet. Возвращает несколько таблиц...</div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00813">SysConnect.cs:813</a></div></div>
<div class="ttc" id="namespace_f_b_a_html_abb5a0756c159f22dc419a5fcf5b6f3b5"><div class="ttname"><a href="namespace_f_b_a.html#abb5a0756c159f22dc419a5fcf5b6f3b5">FBA.CommandCode</a></div><div class="ttdeci">CommandCode</div><div class="ttdoc">Команды от клиента серверу приложений, список возможных команд: Все возможные типы сообщений между се...</div><div class="ttdef"><b>Definition:</b> <a href="_sys_static_8cs_source.html#l00573">SysStatic.cs:573</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a766238aedcab93fcd7d4836db4550e31"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a766238aedcab93fcd7d4836db4550e31">FBA.Connection.ConnectionClose</a></div><div class="ttdeci">bool ConnectionClose()</div><div class="ttdoc">Функция закрытия соединения с БД.  </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00450">SysConnect.cs:450</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a167e00898afa701230592d060c6d2e2c"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a167e00898afa701230592d060c6d2e2c">FBA.Connection.GetInsertID</a></div><div class="ttdeci">string GetInsertID()</div><div class="ttdoc">Получить код для получения ID вставленной/изменённой записи. Postgre: &quot;; RETURNING id; &quot;;  MSSQL: &quot;; ...</div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00876">SysConnect.cs:876</a></div></div>
<div class="ttc" id="namespace_fast_colored_text_box_n_s_html"><div class="ttname"><a href="namespace_fast_colored_text_box_n_s.html">FastColoredTextBoxNS</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a3cd37446a3a7203f48d984526b4849e5"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a3cd37446a3a7203f48d984526b4849e5">FBA.Connection.ConnectionGUID</a></div><div class="ttdeci">string ConnectionGUID</div><div class="ttdoc">Текущий GUID, выданый сервером проложений по которому определяется Connection к БД. Это основой GUID сессии приложения, возвращенный сервером приложений. В рамках сессии выполняются транзакции. Для того чтобы выполнить новую транзакцию, пока не закончилась предыдущая, нужно получить от сервера приложений новый GUID соединения с БД (т.е. новый Connection). </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00076">SysConnect.cs:76</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_ad362a30163e3a237460e0d5b2cb124d2"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#ad362a30163e3a237460e0d5b2cb124d2">FBA.Connection.ConnectionID</a></div><div class="ttdeci">string ConnectionID</div><div class="ttdoc">ИД соединения. Это GUID. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00058">SysConnect.cs:58</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a99f3a0c81f814bb49d075ea382e51b71"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a99f3a0c81f814bb49d075ea382e51b71">FBA.Connection.GetValue4</a></div><div class="ttdeci">bool GetValue4(string sql, out string s1, out string s2, out string s3, out string s4)</div><div class="ttdoc">Получение 4-ми значений. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00557">SysConnect.cs:557</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a49b48dd82db1f15bdaa4ede9eab9c2cc"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a49b48dd82db1f15bdaa4ede9eab9c2cc">FBA.Connection.GetValueArr</a></div><div class="ttdeci">bool GetValueArr(string sql, ref string[] arr)</div><div class="ttdoc">Получение больше 10-ти значений. В массиве строк. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00735">SysConnect.cs:735</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a79f620faffaf2bc26837bfe8d4ef368b"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a79f620faffaf2bc26837bfe8d4ef368b">FBA.Connection.GetValue8</a></div><div class="ttdeci">bool GetValue8(string sql, out string s1, out string s2, out string s3, out string s4, out string s5, out string s6, out string s7, out string s8)</div><div class="ttdoc">Получение 8-ми значений. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00641">SysConnect.cs:641</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a9f13d1affbfe468eeaca4daffa9b21d1"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a9f13d1affbfe468eeaca4daffa9b21d1">FBA.Connection.ConnectionGetParamName</a></div><div class="ttdeci">bool ConnectionGetParamName(string connectionName, out string connectionID, out string serverType, out string serverName, out string databaseName, out string databaseLogin, out string databasePass, out string userForm, out string userLogin, out string userPass, out string windowsLogin)</div><div class="ttdoc">Метод возвращает все настройки соединения по имени соединения из табицы ConnectionList. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00416">SysConnect.cs:416</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a220dc571237011f2e0afddd935cacd6d"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a220dc571237011f2e0afddd935cacd6d">FBA.Connection.GetValue7</a></div><div class="ttdeci">bool GetValue7(string sql, out string s1, out string s2, out string s3, out string s4, out string s5, out string s6, out string s7)</div><div class="ttdoc">Получение 7-ми значений. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00620">SysConnect.cs:620</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_ae89cedd48e08f769139faa24d29941aa"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#ae89cedd48e08f769139faa24d29941aa">FBA.Connection.ConnectionActive</a></div><div class="ttdeci">bool ConnectionActive</div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00063">SysConnect.cs:63</a></div></div>
<div class="ttc" id="namespace_f_b_a_html"><div class="ttname"><a href="namespace_f_b_a.html">FBA</a></div><div class="ttdef"><b>Definition:</b> <a href="_resource_8_designer_8cs_source.html#l00011">Resource.Designer.cs:11</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a7af426539c14090db733c18b37cfc1f5"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a7af426539c14090db733c18b37cfc1f5">FBA.Connection.DatabaseName</a></div><div class="ttdeci">string DatabaseName</div><div class="ttdoc">База СУБД на сервере. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00111">SysConnect.cs:111</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a226d4baf3be0676551817c1ae46fbaa9"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a226d4baf3be0676551817c1ae46fbaa9">FBA.Connection.ConnectionSetLocal</a></div><div class="ttdeci">bool ConnectionSetLocal()</div><div class="ttdoc">Установка соединения с SQLite; </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00192">SysConnect.cs:192</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a556479c8ba68bce8cee63c53e8583c14"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a556479c8ba68bce8cee63c53e8583c14">FBA.Connection.ServerAppPort</a></div><div class="ttdeci">int ServerAppPort</div><div class="ttdoc">На каком порту обмениваемся сообщениями с сервером приложений. По умолчанию 7145. ...</div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00151">SysConnect.cs:151</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a17c79b7810deb7e632187a146a27d725"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a17c79b7810deb7e632187a146a27d725">FBA.Connection.SelectDT</a></div><div class="ttdeci">bool SelectDT(string sql, out System.Data.DataTable dt)</div><div class="ttdoc">Функция получения данных для MSSQL, Postgre, SQLite. Результат в DataTable. Возвращает только одну та...</div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00778">SysConnect.cs:778</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a9d5433bfc95420f963f932439dd5a838"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a9d5433bfc95420f963f932439dd5a838">FBA.Connection.GetValue</a></div><div class="ttdeci">string GetValue(string sql)</div><div class="ttdoc">Получение одного значений. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00491">SysConnect.cs:491</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_ab11d0b86feaf69fbb49846f4537145ce"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#ab11d0b86feaf69fbb49846f4537145ce">FBA.Connection.GetValue5</a></div><div class="ttdeci">bool GetValue5(string sql, out string s1, out string s2, out string s3, out string s4, out string s5)</div><div class="ttdoc">Получение 5-ми значений. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00578">SysConnect.cs:578</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a50231c21a05c72ecab89a5b347941462"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a50231c21a05c72ecab89a5b347941462">FBA.Connection.GetValue6</a></div><div class="ttdeci">bool GetValue6(string sql, out string s1, out string s2, out string s3, out string s4, out string s5, out string s6)</div><div class="ttdoc">Получение 6-ми значений. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00599">SysConnect.cs:599</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a9b58e4b1c4ca9af6571431806c0e17a9"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a9b58e4b1c4ca9af6571431806c0e17a9">FBA.Connection.UserPass</a></div><div class="ttdeci">string UserPass</div><div class="ttdoc">Пароль пользователя в таблице fbaUser.  </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00136">SysConnect.cs:136</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a6ce212094097c98af886a3417b1510cc"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a6ce212094097c98af886a3417b1510cc">FBA.Connection.UserForm</a></div><div class="ttdeci">string UserForm</div><div class="ttdoc">Имя формы для запуска.  </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00126">SysConnect.cs:126</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_ae4e944521bb94857288224ca9f20245a"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#ae4e944521bb94857288224ca9f20245a">FBA.Connection.Connection</a></div><div class="ttdeci">Connection()</div><div class="ttdoc">Конструктор без инициализацией подключения. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00173">SysConnect.cs:173</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_acc4bb0104ca9cb3f480999e5ab9a3116"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#acc4bb0104ca9cb3f480999e5ab9a3116">FBA.Connection.GetValue10</a></div><div class="ttdeci">bool GetValue10(string sql, out string s1, out string s2, out string s3, out string s4, out string s5, out string s6, out string s7, out string s8, out string s9, out string s10)</div><div class="ttdoc">Получение 10-ти значений. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00683">SysConnect.cs:683</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_ad06450c04a115c5f49848d0bc861b63e"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#ad06450c04a115c5f49848d0bc861b63e">FBA.Connection.Name</a></div><div class="ttdeci">string Name</div><div class="ttdoc">Имя данного объекта Connection. Используется для того чтобы разделить команды к серверу приложений...</div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00082">SysConnect.cs:82</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_afb9f211ad33869d0d3ff480a8593cba0"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#afb9f211ad33869d0d3ff480a8593cba0">FBA.Connection.DatabasePass</a></div><div class="ttdeci">string DatabasePass</div><div class="ttdoc">База СУБД - пароль.  </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00121">SysConnect.cs:121</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_af8d3357489e91efcf98ebf7b56110348"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#af8d3357489e91efcf98ebf7b56110348">FBA.Connection.ServerAppName</a></div><div class="ttdeci">string ServerAppName</div><div class="ttdoc">Имя сервера прилоежний. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00146">SysConnect.cs:146</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a963bce9db48309a24f9e5360255f7f5e"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a963bce9db48309a24f9e5360255f7f5e">FBA.Connection.GetValue9</a></div><div class="ttdeci">bool GetValue9(string sql, out string s1, out string s2, out string s3, out string s4, out string s5, out string s6, out string s7, out string s8, out string s9)</div><div class="ttdoc">Получение 9-х значений. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00662">SysConnect.cs:662</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_aa20952e5caba14009de078611bffc06e"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#aa20952e5caba14009de078611bffc06e">FBA.Connection.DatabaseLogin</a></div><div class="ttdeci">string DatabaseLogin</div><div class="ttdoc">База СУБД - логин. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00116">SysConnect.cs:116</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a085fd480090159a0192a3cfdc2075574"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a085fd480090159a0192a3cfdc2075574">FBA.Connection.Connection</a></div><div class="ttdeci">Connection(ServerType serverType, string ServerName, string DatabaseLogin, string DatabasePass, string DatabaseName)</div><div class="ttdoc">Конструктор с инициализацией подключения. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00179">SysConnect.cs:179</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a7e224aeb6f3f7aa7fa641f2bd9330520"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a7e224aeb6f3f7aa7fa641f2bd9330520">FBA.Connection.ConnectionDirect</a></div><div class="ttdeci">bool ConnectionDirect</div><div class="ttdoc">Работа с запросами через сервер прилоежений (false) или прямое подключение (true).  </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00068">SysConnect.cs:68</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html"><div class="ttname"><a href="class_f_b_a_1_1_connection.html">FBA.Connection</a></div><div class="ttdoc">Класс соединения с БД. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00049">SysConnect.cs:49</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_a4da6cc26b934f060dc0c3ca79e9791d0"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#a4da6cc26b934f060dc0c3ca79e9791d0">FBA.Connection.UserLogin</a></div><div class="ttdeci">string UserLogin</div><div class="ttdoc">Логин пользователя в таблице fbaUser.  </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l00131">SysConnect.cs:131</a></div></div>
<div class="ttc" id="class_f_b_a_1_1_connection_html_ab06c1ddb28525efd92457b44392378c4"><div class="ttname"><a href="class_f_b_a_1_1_connection.html#ab06c1ddb28525efd92457b44392378c4">FBA.Connection.SelectCB</a></div><div class="ttdeci">bool SelectCB(string sql, ComboBox cb)</div><div class="ttdoc">Функции получения данных для MSSQL, Postgre, SQLite. Результат в ComboBox. </div><div class="ttdef"><b>Definition:</b> <a href="_sys_connect_8cs_source.html#l01029">SysConnect.cs:1029</a></div></div>
<div class="ttc" id="_sys_money_8cs_html_a81a223a02c34d82b47199f08308847f2"><div class="ttname"><a href="_sys_money_8cs.html#a81a223a02c34d82b47199f08308847f2">System</a></div><div class="ttdeci">﻿using System</div><div class="ttdef"><b>Definition:</b> <a href="_sys_money_8cs_source.html#l00002">SysMoney.cs:2</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Создано системой &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
